<div class="hbox hbox-auto-xs hbox-auto-sm" ng-init="
    app.settings.asideFolded = true;
    app.settings.asideDock = true;
  ">
    <div class="bg-light lter b-b wrapper-md">
        <h1 class="m-n font-thin h3">Devices</h1>
    </div>
    <div class="wrapper-md">
        
        <div ng-controller="espDeviceListController">

            <toaster-container toaster-options="{'position-class': 'toast-bottom-right', 'close-button':true}"></toaster-container>

            <div class="row" ng-repeat="(deviceKey, deviceItem) in devices">                

                <div class="col-md-6" ng-controller="espDeviceItemController" ng-init="init(deviceItem)">

                    <div class="panel panel-default">
                        <div class="panel-heading font-bold">Device {{deviceKey + 1}}</div>
                        <div class="panel-body">

                            <form class="form-horizontal form-validation">
                                <div class="form-group">
                                    <label class="col-lg-4 control-label">Status</label>
                                    <div class="col-lg-8">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <i ng-class="device.isConnected ? 'text-success-dker' : 'text-danger-dker'" class="glyphicon glyphicon-off icon"></i>
                                            </span>
                                            <input type="text" class="form-control" readonly value="{{device.isConnected ? 'On-line' : 'Off-line'}}">
                                        </div>
                                    </div>
                                </div>                                
                                <div class="form-group">
                                    <label class="col-lg-4 control-label">Última atualização</label>
                                    <div class="col-lg-8">
                                        <input type="text" class="form-control" readonly value="{{device.epochTimeUtc == null ? '' : device.epochTimeUtc * 1000 | date:'dd/MM/yyyy HH:mm:ss Z'}}">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-4 control-label">Wifi Quality</label>
                                    <div class="col-lg-8">
                                        <input type="text" class="form-control" readonly uppercased ng-model="device.wifiQuality">
                                    </div>
                                </div>
                            </form>

                            <tabset justified="true" class="tab-container">
                                <tab heading="Sensor {{sensorKey + 1}}" ng-repeat="(sensorKey, sensorItem) in device.sensors">
                                    <div ng-controller="dsFamilyTempSensorItemController" ng-init="init(sensorItem)">
                                        <div style="height:240px">
                                            <nvd3 options="options" data="sensor.chart"></nvd3>
                                        </div>
                                        <form name="formDevice" class="form-horizontal">
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Status</label>
                                                <div class="col-lg-8">
                                                    <div class="input-group">
                                                        <span class="input-group-addon">
                                                            <i ng-class="sensor.isConnected ? 'text-success-dker' : 'text-danger-dker'" class="glyphicon glyphicon-off icon"></i>
                                                        </span>
                                                        <input type="text" class="form-control" readonly value="{{sensor.isConnected ? 'On-line' : 'Off-line'}}">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Temperatura</label>
                                                <div class="col-lg-8">
                                                    <input type="text" class="form-control" readonly value="{{sensor.tempCelsius == null ? '' : convertTemperature(sensor.tempCelsius) | number : resolution.selectedResolution.decimalPlaces}} {{scale.selectedScale.symbol}}">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Range</label>
                                                <div class="col-lg-8">
                                                    <input type="text" class="form-control" readonly value="{{tempSensorRangeView.min}}{{scale.selectedScale.symbol}} a {{tempSensorRangeView.max}}{{scale.selectedScale.symbol}}">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Escalas</label>
                                                <div class="col-lg-8">
                                                    <select class="form-control m-b" ng-options="item.name for item in scale.availableScales track by item.id" ng-model="scale.selectedScale" ng-change="changeScale()"></select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Resolução</label>
                                                <div class="col-lg-8">
                                                    <select class="form-control m-b" ng-options="item.name for item in resolution.availableResolutions track by item.id" ng-model="resolution.selectedResolution" ng-change="changeResolution()"></select>
                                                </div>
                                            </div>
                                            <div class="line line-dashed b-b line-lg pull-in"></div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Tem alarme alto</label>
                                                <div class="col-lg-8">
                                                    <div class="checkbox">
                                                        <label class="i-checks">
                                                            <input type="checkbox" ng-model="highAlarmView.alarmOn" ng-change="changeAlarmOn('High', highAlarmView.alarmOn)"><i></i>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Tem buzzer alto</label>
                                                <div class="col-lg-8">
                                                    <div class="checkbox">
                                                        <label class="i-checks">
                                                            <input ng-disabled="!highAlarmView.alarmOn" type="checkbox" ng-model="highAlarmView.alarmBuzzerOn" ng-change="changeAlarmBuzzerOn('High', highAlarmView.alarmBuzzerOn)"><i></i>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Alarme alto</label>
                                                <div class="col-lg-8">
                                                    <input name="inputHighAlarmValue"
                                                           type="number"
                                                           ng-model="highAlarmView.alarmValue"
                                                           ng-model-options="{ debounce: 1000 }"
                                                           ng-change="changeAlarmValue('High', highAlarmView.alarmValue)"
                                                           min="{{tempSensorRangeView.min}}"
                                                           max="{{tempSensorRangeView.max}}"
                                                           ng-disabled="!highAlarmView.alarmOn"
                                                           required
                                                           class="form-control">
                                                    <span ng-show="formDevice.inputHighAlarmValue.$touched && formDevice.inputHighAlarmValue.$invalid">
                                                        Alarme alto deve estar entre {{tempSensorRangeView.min}}{{scale.selectedScale.symbol}} e {{tempSensorRangeView.max}}{{scale.selectedScale.symbol}}
                                                    </span>

                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Tem alarme baixo</label>
                                                <div class="col-lg-8">
                                                    <div class="checkbox">
                                                        <label class="i-checks">
                                                            <input type="checkbox" ng-model="lowAlarmView.alarmOn" ng-change="changeAlarmOn('Low', lowAlarmView.alarmOn)"><i></i>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Tem buzzer baixo</label>
                                                <div class="col-lg-8">
                                                    <div class="checkbox">
                                                        <label class="i-checks">
                                                            <input ng-disabled="!lowAlarmView.alarmOn" type="checkbox" ng-model="lowAlarmView.alarmBuzzerOn" ng-change="changeAlarmBuzzerOn('Low', lowAlarmView.alarmBuzzerOn)"><i></i>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Alarme baixo</label>
                                                <div class="col-lg-8">
                                                    <input name="inputLowAlarmValue"
                                                           type="number"
                                                           ng-model="lowAlarmView.alarmValue"
                                                           ng-model-options="{ debounce: 1000 }"
                                                           ng-change="changeAlarmValue('Low', lowAlarmView.alarmValue)"
                                                           min="{{tempSensorRangeView.min}}"
                                                           max="{{tempSensorRangeView.max}}"
                                                           ng-disabled="!lowAlarmView.alarmOn"
                                                           class="form-control">
                                                    <span ng-show="formDevice.inputLowAlarmValue.$touched && formDevice.inputLowAlarmValue.$invalid">
                                                        Alarme baixo deve estar entre {{tempSensorRangeView.min}}{{scale.selectedScale.symbol}} e {{tempSensorRangeView.max}}{{scale.selectedScale.symbol}}
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="line line-dashed b-b line-lg pull-in"></div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Limite do gráfico alto</label>
                                                <div class="col-lg-8">
                                                    <input name="inputHighChartLimiterValue"
                                                           type="number"
                                                           ng-model="highChartLimiterView"
                                                           ng-model-options="{ debounce: 1000 }"
                                                           ng-change="changeChartLimiterValue('High', highChartLimiterView)"
                                                           min="{{tempSensorRangeView.min}}"
                                                           max="{{tempSensorRangeView.max}}"
                                                           class="form-control">
                                                    <span ng-show="formDevice.inputHighChartLimiterValue.$touched && formDevice.inputHighChartLimiterValue.$invalid">
                                                        Limite alto do gráfico deve estar entre {{tempSensorRangeView.min}}{{scale.selectedScale.symbol}} e {{tempSensorRangeView.max}}{{scale.selectedScale.symbol}}
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-4 control-label">Limite do gráfico baixo</label>
                                                <div class="col-lg-8">
                                                    <input name="inputLowChartLimiterValue"
                                                           type="number"
                                                           ng-model="lowChartLimiterView"
                                                           ng-model-options="{ debounce: 1000 }"
                                                           ng-change="changeChartLimiterValue('Low', lowChartLimiterView)"
                                                           min="{{tempSensorRangeView.min}}"
                                                           max="{{tempSensorRangeView.max}}"
                                                           class="form-control">
                                                    <span ng-show="formDevice.inputLowChartLimiterValue.$touched && formDevice.inputLowChartLimiterValue.$invalid">
                                                        Limite baixo do gráfico deve estar entre {{tempSensorRangeView.min}}{{scale.selectedScale.symbol}} e {{tempSensorRangeView.max}}{{scale.selectedScale.symbol}}
                                                    </span>
                                                </div>
                                            </div>
                                        </form>
                                    </div>                                
                                </tab>
                            </tabset>

                        </div>
                    </div>

                </div>
            </div>
        </div>                
    </div>
</div>